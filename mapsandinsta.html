<!DOCTYPE html>
<html>
<head>
  <title>FBF</title>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta charset="utf-8">
  <script src="http://code.jquery.com/jquery-latest.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
  <script src="http://cooper-union-maps-proxy.herokuapp.com/js/draw.js"></script>
  <script>

  //hold all the filter names

  var pictures={
    // filters: {[
    //   'Normal': {
    //     'array': [],
    //   },
    //   '1977': {
    //     'array': [],
    //   },
    //   'Amaro': {
    //     'array': [],
    //   },
    //   'Brannan': {
    //     'array': [],
    //   },
    //   'Earlybird': {
    //     'array': [],
    //   },
    //   'Hefe': {
    //     'array': [],
    //   },
    //   'Hudson': {
    //     'array': [],
    //   },
    //   'Inkwell': {
    //     'array': [],
    //   },
    //   'Kelvin': {
    //     'array': [],
    //   },
    //   'Lo-fi': {
    //     'array': [],
    //   },
    //   'Mayfair': {
    //     'array': [],
    //   },
    //   'Nashville': {
    //     'array': [],
    //   },
    //   'Rise': {
    //     'array': [],
    //   },
    //   'Sierra': {
    //     'array': [],
    //   },
    //   'Sutro': {
    //     'array': [],
    //   },
    //   'Toaster': {
    //     'array': [],
    //   },
    //   'Valencia': {
    //     'array': [],
    //   },
    //   'Walden': {
    //     'array': [],
    //   },
    //   'Willow': {
    //     'array': [],
    //   },
    //   'X-Pro II': {
    //     'array': [],
    //   },
    //   'Slumber': {
    //     'array': [],
    //   },
    //   'Cream': {
    //     'array': [],
    //   },
    //   'Ludwig': {
    //     'array': [],
    //   },
    //   'Aden': {
    //     'array': [],
    //   },
    //   'Perpetua': {
    //     'array': [],
    //   },
    //   'Juno': {
    //     'array': [],
    //   },
    //   'Clarendon': {
    //     'array': [],
    //   }
    // ]
    //}
    filters: [
      'Normal',
      '1977',
      'Amaro',
      'Brannan',
      'Earlybird',
      'Hefe',
      'Hudson',
      'Inkwell',
      'Kelvin',
      'Lo-fi',
      'Mayfair',
      'Nashville',
      'Rise',
      'Sierra',
      'Sutro',
      'Toaster',
      'Valencia',
      'Walden',
      'Willow',
      'X-Pro II',
      'Slumber',
      'Cream',
      'Ludwig',
      'Aden',
      'Perpetua',
      'Juno',
      'Clarendon'],
    array: [
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [],
      [], []
    ]
  };
  var mapOptions = {
    zoom: 12,
    center: new google.maps.LatLng(40.690983,-73.9964327) //center of map NYC
  };

  $(document).ready(function(){
    //add filter options to select
    //var filterKeys = Object.keys(pictures.filters);
    for(var k = 0; k < pictures.filters.length; k++){
      $('select').append("<option value="+pictures.filters[k]+ ">"+ pictures.filters[k] + "</option>");
    }

    $.getJSON("http://cooper-union-instagram-proxy.herokuapp.com/search/tag/nyc?count=200", function(response){
        console.log(response);
        console.log(pictures);
        //loop through all results
        for(var i=0; i<response.length; i++) {
          console.log(response[i]);
          //if there is a location tagged
          if(response[i].location != null){
            //add to pictures array to corresponding filter
            var f = response[i].filter;
            var index = pictures.filters.indexOf(f);
            //  console.log(f);
            //  console.log(pictures.filters);
            //  console.log(pictures.filters.indexOf(f));
            //  console.log(pictures.array[pictures.filters.indexOf(f)]);
            //if filter is listed in array
            if(index > -1) {
              pictures.array[index].push({
                'title': response[i].caption.text,
                'map': new google.maps.LatLng(response[i].location.latitude, response[i].location.longitude),
                'link': response[i].link,
                'html':'<img src=\''+response[i].images.thumbnail.url+'\n\'/>'
              });
            }
          }
        }
        console.log(pictures.array[0]);
        draw('map', mapOptions, pictures.array[0]);
      });

    $('select').change(function () {
        //get selected filter
        var filterChoice = $(this).val();
        console.log(filterChoice);
        console.log(pictures.array[pictures.filters.indexOf(filterChoice)]);
        draw('map', mapOptions, pictures.array[pictures.filters.indexOf(filterChoice)]);
      });

  });
  </script>
  <style>
      #map {
        height:800px;
        width:800px;
        margin: auto;
      }
      select{
        /*visibility: hidden;*/
      }
  </style>
</head>
<body>
  <h1>Filter By Filter in NYC</h1>
  <!-- <form>
    Enter Search Term:<br>
    <input type="text" name="search" value="nyc">
    <br><br>
    <input type="submit" value="Submit">
  </form> -->
  <p>Select a filter type below!</p>
  <select>
  </select>
  <div id="map"></div>
</body>
</html>
